using NUnit.Framework;
using OpenQA.Selenium;

[TestFixture]
public class RunTests
{
    private IWebDriver driver;

    [SetUp]
    public void Setup()
    {
        // Initialize the WebDriver before each test
        driver = new ChromeDriver();
        driver.Manage().Window.Maximize();
    }

    [TearDown]
    public void Teardown()
    {
        // Clean up the WebDriver after each test
        driver.Quit();
    }

    [Test]
    public void TestLoginSuccess()
    {
        // Arrange
        driver.Navigate().GoToUrl("https://runpayroll-qafit.nj.adp.com/");
        WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(25));

        // Wait for the page to load
        wait.Until(driver => ((IJavaScriptExecutor)driver).ExecuteScript("return document.readyState").Equals("complete"));

        // Wait for the URL to contain the expected value
        wait.Until(ExpectedConditions.UrlContains("https://online-fit.nj.adp.com/"));

        // Act
        Run.Login(driver, wait);

        // Wait for the URL after login
        wait.Until(ExpectedConditions.UrlContains("https://runpayrollmain2-qafit.nj.adp.com/"));

        // Assert
        string currentUrl = driver.Url;
        Assert.IsTrue(currentUrl.Contains("https://runpayrollmain2-qafit.nj.adp.com/"), "Login failed. Test Failed!");
    }
}
